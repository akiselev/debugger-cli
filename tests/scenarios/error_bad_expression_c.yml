# Bad Expression Error Test
# Tests error handling for syntax error in expression evaluation

name: "C Bad Expression Test"
description: "Verifies error when evaluating malformed expression"

setup:
  - shell: "gcc -g tests/fixtures/simple.c -o tests/fixtures/test_simple_c"

target:
  program: "../fixtures/test_simple_c"
  adapter: "lldb"
  stop_on_entry: true

steps:
  # Set breakpoint at main start
  - action: command
    command: "break simple.c:19"
    expect:
      success: true

  # Continue to breakpoint
  - action: command
    command: "continue"

  - action: await
    timeout: 10
    expect:
      reason: "breakpoint"

  # Attempt to evaluate expression with syntax error
  # expect.success: false allows the evaluation to fail gracefully
  - action: evaluate
    expression: "1 + + 2"
    expect:
      success: false
      result_contains: "error"

  - action: command
    command: "continue"

  - action: await
    timeout: 10
    expect:
      reason: "exited"
